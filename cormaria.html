<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Aprenda Cores - Jogo Educativo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS for animations and specific elements */
        .color-button {
            transition: all 0.3s ease;
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
        }
        
        .color-button:active {
            transform: scale(0.95);
        }
        
        .color-button.correct {
            animation: pulseCorrect 0.8s;
            box-shadow: 0 0 20px 10px rgba(255, 255, 255, 0.7);
        }
        
        .color-button.wrong {
            animation: shake 0.5s;
            background-color: #000000 !important; /* tom escuro de vermelho */
        }

        /* Animação shake */
        @keyframes shake {
            0% { transform: translateX(0); }
            20% { transform: translateX(-10px); }
            40% { transform: translateX(10px); }
            60% { transform: translateX(-10px); }
            80% { transform: translateX(10px); }
            100% { transform: translateX(0); }
        }
        
        @keyframes pulseCorrect {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Stars animation */
        .stars-container {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
        }
        
        .star {
            position: absolute;
            width: 30px;
            height: 30px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23F59E0B"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>');
            background-size: contain;
            animation: floatStar 1.5s ease-out forwards;
            opacity: 0;
        }
        
        @keyframes floatStar {
            0% { transform: translate(0, 0) scale(0); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(1.5); opacity: 0; }
        }
        
        /* Responsive font sizes */
        .instruction-text {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
        }
        
        .color-name {
            font-size: clamp(2rem, 8vw, 3.5rem);
        }
        
        /* Vibrant color classes */
        .vermelho { background-color: #FF0000; }
        .azul { background-color: #0066FF; }
        .verde { background-color: #00CC00; }
        .branco { background-color: #FFFFFF; border: 3px solid #E5E7EB; color: #000; }
        .amarelo { background-color: #FFD700; }
        .rosa { background-color: #e454a3; }
        .laranja { background-color: #FF8000; }
        .marrom { background-color: #411c03; }

        
        /* Progress medal */
        .medal {
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-center p-4">
    <div class="w-full max-w-3xl bg-white rounded-2xl shadow-xl p-6 relative overflow-hidden">
        <!-- Stars container for celebration -->
        <div id="starsContainer" class="stars-container"></div>
        
        <!-- Game Title -->
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">Aprenda Cores</h1>
        
        <!-- Progress Display -->
        <div class="flex items-center justify-center mb-4">
            <div class="medal bg-yellow-400 w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-xl mr-2">
                <span id="scoreCount">0</span>
            </div>
            <span class="text-lg font-medium text-gray-700">Acertos</span>
        </div>
        
        <!-- Instruction Area -->
        <div class="text-center mb-8">
            <p class="instruction-text font-semibold text-gray-700">Toque na cor:</p>
            <p id="currentColor" class="color-name font-bold text-gray-900"></p>
        </div>
        
        <!-- Color Buttons Grid -->
        <div class="grid grid-cols-2 gap-4 mb-8">
            <!-- Buttons will be generated by JavaScript -->
        </div>
        
        <!-- Controls -->
        <div class="flex justify-center space-x-4">
            <button id="repeatBtn" class="px-6 py-3 bg-blue-600 text-white rounded-full font-medium hover:bg-blue-700 transition flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
                </svg>
                Repetir
            </button>
            <button id="modeBtn" class="px-6 py-3 bg-purple-600 text-white rounded-full font-medium hover:bg-purple-700 transition">
                Modo Livre
            </button>
        </div>
    </div>
    
    <!-- Audio elements for feedback sounds -->
    <audio id="correctSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>
    <audio id="wrongSound" src="https://assets.mixkit.co/sfx/preview/mixkit-warning-alarm-688.mp3"></audio>
    <audio id="celebrationSound" src="https://assets.mixkit.co/sfx/preview/mixkit-happy-crowd-cheer-964.mp3"></audio>
    <audio id="congratsSound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
    
    <script>
        // Game configuration
        const colors = [
            { name: "vermelho", class: "vermelho" },
            { name: "azul", class: "azul" },
            { name: "verde", class: "verde" },
            { name: "branco", class: "branco" },
            { name: "amarelo", class: "amarelo" },
            { name: "laranja", class: "laranja" },
            { name: "rosa", class: "rosa" },
            { name: "marrom", class: "marrom" } 
        ];
        let lastColor = null;

        const frasesAcerto = [
            "Parabéns!",
            "Muito bem!",
            "Você arrasou!",
            "Ótimo trabalho!",
            "Isso mesmo!",
            "Mandou bem!",
            "Excelente!",
            "Isso aí!",
            "Boa!",
            "Ótimo!",
            "Muito inteligente!"
        ];

        // Game state
        let currentTargetColor = null;
        let colorButtons = [];
        let correctButtonIndex = null;
        let gameActive = true; // True: modo desafio, False: modo livre
        let score = 0;
        const maxScore = 10;

        // Elements
        const buttonsContainer = document.querySelector('.grid');
        const currentColorElement = document.getElementById('currentColor');
        const scoreCount = document.getElementById('scoreCount');
        const repeatBtn = document.getElementById('repeatBtn');
        const modeBtn = document.getElementById('modeBtn');
        const starsContainer = document.getElementById('starsContainer');

        // Sounds
        const correctSound = document.getElementById('correctSound');
        const wrongSound = document.getElementById('wrongSound');
        const celebrationSound = document.getElementById('celebrationSound');
        const congratsSound = document.getElementById('congratsSound');

        // Speech synthesis
        const synth = window.speechSynthesis;

        // Initialize buttons and start game
        generateColorButtons();
        startNewRound();

        // Generate color buttons dynamically
        function generateColorButtons() {
            buttonsContainer.innerHTML = '';
            colorButtons = [];

            colors.forEach(color => {
                const button = document.createElement('button');
                button.className = `color-button ${color.class} w-full h-24 rounded-xl`;
                button.setAttribute('data-color', color.name);
                button.setAttribute('aria-label', `Cor ${color.name}`);
                button.addEventListener('click', () => handleColorClick(button));
                buttonsContainer.appendChild(button);
                colorButtons.push(button);
            });
        }

        // Start a new round: pick a target color and speak it
        function startNewRound() {
            if (!gameActive) {
                // Modo livre: pode clicar em qualquer botão, só pronuncia a cor
                currentTargetColor = null;
                currentColorElement.textContent = "Escolha uma cor!";
                return;
            }

            correctButtonIndex = Math.floor(Math.random() * colorButtons.length);
            currentTargetColor = colors.find(color =>
                colorButtons[correctButtonIndex].classList.contains(color.class)
            );
            currentColorElement.textContent = currentTargetColor.name;
            speakColorName(currentTargetColor.name);
        }

        // Pronounce the color name
        function speakColorName(name) {
            if (synth.speaking) synth.cancel();
            const utter = new SpeechSynthesisUtterance(name);
            utter.lang = 'pt-BR';
            synth.speak(utter);
        }

        // Handle button click
        function handleColorClick(button) {
            const selectedColor = button.getAttribute('data-color');

            if (!gameActive) {
                // Modo livre: pronuncia a cor clicada
                speakColorName(selectedColor);
                return;
            }

            if (selectedColor === currentTargetColor.name) {
                playCorrectAnimation(button);
                incrementScore();
               
                startNewRound();
            } else {
                playWrongAnimation(button);
                speakColorName("Tente novamente!");
            }
        }

        // Increment the score and update display
        function incrementScore() {
            score++;
            scoreCount.textContent = score;
        }

        // Play correct animation and sound
        function playCorrectAnimation(button) {
            button.classList.add('correct');
            correctSound.currentTime = 0;
            correctSound.play();
            setTimeout(() => button.classList.remove('correct'), 800);
        }

        // Play wrong animation and sound
        function playWrongAnimation(button) {
            button.classList.add('wrong');
            wrongSound.currentTime = 0;
            wrongSound.play();
            setTimeout(() => button.classList.remove('wrong'), 500);
        }

        // Celebration animation with stars and sound
        function playCelebration() {
            celebrationSound.currentTime = 0;
            celebrationSound.play();
            congratsSound.currentTime = 0;
            congratsSound.play();
            createStars(15);
        }

        // Create animated stars floating around
        function createStars(count) {
            for (let i = 0; i < count; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                star.style.top = `${50 + (Math.random() * 100) - 50}px`;
                star.style.left = `${50 + (Math.random() * 100) - 50}px`;
                star.style.setProperty('--tx', `${(Math.random() * 200) - 100}px`);
                star.style.setProperty('--ty', `${(Math.random() * -150) - 100}px`);
                starsContainer.appendChild(star);
                // Remove star after animation completes
                star.addEventListener('animationend', () => star.remove());
            }
        }

        // Repeat current color name pronunciation
        repeatBtn.addEventListener('click', () => {
            if (currentTargetColor) {
                speakColorName(currentTargetColor.name);
            }
        });

        // Toggle game mode between desafio e modo livre
        modeBtn.addEventListener('click', () => {
            if (gameActive) {
                // Passar para modo livre
                gameActive = false;
                modeBtn.textContent = 'Modo Desafio';
                currentColorElement.textContent = "Escolha uma cor!";
            } else {
                // Voltar para modo desafio
                gameActive = true;
                score = 0;
                scoreCount.textContent = score;
                modeBtn.textContent = 'Modo aprendizado';
                startNewRound();
            }
        });

    </script>
</body>
</html>
